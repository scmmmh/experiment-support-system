<!DOCTYPE html>
<html xmlns:py="http://genshi.edgewall.org/" xmlns:xi="http://www.w3.org/2001/XInclude">
  <xi:include href="../../layout/backend.html"/>
  <head>
    <title>${user.display_name} - Permissions</title>
  </head>
  <body>
    ${h.ui.breadcrumbs([('Users', {'href': r.route_url('user')}), (user.display_name, {'href': r.route_url('user.view', uid=user.id)}), ('Permissions', {'href': r.route_url('user.permissions', uid=user.id)})], r)}
    <hgroup>
      <h1>${user.display_name} - Permissions</h1>
    </hgroup>
    <form action="${r.route_url('user.permissions', uid=user.id)}" method="post">
      ${h.form.csrf_token(r.session.get_csrf_token())}
      ${e}
      <section>
        <hgroup>
          <h2>Groups</h2>
        </hgroup>
        <ul>
          <li py:for="group in groups">${h.form.checkbox('gid', group.id, e, label=group.title, checked=(unicode(group.id) in has_groups))}</li>
        </ul>
      </section>
      <section>
        <hgroup>
          <h2>Individual permissions</h2>
        </hgroup>
        <ul>
          <li py:for="permission in permissions">${h.form.checkbox('pid', permission.id, e, label=permission.title, checked=(unicode(permission.id) in has_permissions))}</li>
        </ul>
      </section>
      <ul class="buttons">
        <li>${h.form.button("Don't update", class_='button', onclick="document.location='%s'" % r.route_url('user.view', uid=user.id))}</li>
        <li>${h.form.submit('Update', class_='button')}</li>
      </ul>
    </form>
  </body>
</html>