<!DOCTYPE html>
<html xmlns:py="http://genshi.edgewall.org/" xmlns:xi="http://www.w3.org/2001/XInclude">
  <xi:include href="../../layout/backend.html"/>
  <head>
    <title>${user.display_name}</title>
  </head>
  <body>
    ${h.ui.breadcrumbs([('Users', {'href': r.route_url('user')}), (user.display_name, {'href': r.route_url('user.view', uid=user.id)})], r)}
    <nav class="toolbar">
      <ul>
        <li><a href="${r.route_url('user.edit', uid=user.id)}" class="button">Edit</a></li>
        <li><a href="${r.route_url('user.permissions', uid=user.id)}" class="button">Permissions</a></li>
        <li><a href="${r.route_url('user.delete', uid=user.id)}" class="button post-submit" data-confirm="Please confirm that you wish to delete this user and all their experiments and data.">Delete</a></li>
      </ul>
    </nav>
    <hgroup>
      <h1>${user.display_name}</h1>
    </hgroup>
    <dl>
      <dt>Username</dt>
      <dd>${user.username}</dd>
      <dt>E-Mail</dt>
      <dd><a href="mailto:${user.email}">${user.email}</a></dd>
    </dl>
    <section>
      <hgroup>
        <h2><a href="${r.route_url('survey')}">Experiments</a></h2>
      </hgroup>
      <table>
        <thead>
          <tr>
            <th>Experiment</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr py:for="survey in surveys">
            <td><a href="${r.route_url('survey.view', sid=survey.id)}">${survey.title}</a></td>
            <td>${h.survey.fancy_status(r, survey, class_='survey-status no-menu')}</td>
            <td>
              <ul class="inline no-symbol no-margin">
                <li><a href="${r.route_url('survey.qsheet.new', sid=survey.id)}" class="button">Add page</a></li>
                <li><a href="${r.route_url('survey.edit', sid=survey.id)}" class="button">Edit</a></li>
                <li><a href="${r.route_url('survey.delete', sid=survey.id)}" class="button">Delete</a></li>
                <li py:if="survey.status == 'develop'"><a href="${r.route_url('survey.status', sid=survey.id, _query={'status': 'testing'})}" class="button post-submit" data-confirm="no-confirm">Test</a></li>
                <li py:if="survey.status == 'testing'"><a href="${r.route_url('survey.status', sid=survey.id, _query={'status': 'develop'})}" class="button post-submit" data-confirm="no-confirm">Stop Test</a></li>
                <li py:if="survey.status in ['develop', 'paused', 'finished']"><a href="${r.route_url('survey.status', sid=survey.id, _query={'status': 'running'})}" class="button post-submit" data-confirm="no-confirm">Start</a></li>
                <li py:if="survey.status == 'running'"><a href="${r.route_url('survey.status', sid=survey.id, _query={'status': 'paused'})}" class="button post-submit" data-confirm="no-confirm">Pause</a></li>
                <li py:if="survey.status in ['running', 'paused']"><a href="${r.route_url('survey.status', sid=survey.id, _query={'status': 'finished'})}" class="button post-submit" data-confirm="no-confirm">Finish</a></li>
              </ul>
            </td>
          </tr>
        </tbody>
      </table>
    </section>
  </body>
</html>