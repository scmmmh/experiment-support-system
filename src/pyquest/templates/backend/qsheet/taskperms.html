<span xmlns:py="http://genshi.edgewall.org/" xmlns:xi="http://www.w3.org/2001/XInclude">
  <table>
    <tr>
      <td><label>Tasks:  </label><label id="task_list">${h.qsheet.generate_tasks(qsheet.attr_value('task-count'))}</label></td>
      <td>${h.form.number_field('task_count', qsheet.attr_value('task-count', default='0'), e, class_='role-qsheet-permute', style='width:50px', min='0')}</td>
      <td>${h.form.select('task_worb', qsheet.attr_value('task-worb', default='w'), [('w', 'Within'), ('b', 'Between')], e, class_='role-qsheet-permute')}</td>
      <td><label class="task-restriction">Exclude:</label></td>
	<td><label id="task-disallow-repeater" style="display:none">${qsheet.attr_value('task-disallow')}</label>${h.form.select('task_disallow', qsheet.attr_value('task-disallow', default=' '), h.qsheet.task_pairs(qsheet.attr_value('task-count')), e, class_='role-qsheet-permute task-restriction', multiple="True", size="2")}</td>
      <td><label class="task-restriction">Order:</label></td>
	<td><label id="task-order-repeater" style="display:none">${qsheet.attr_value('task-order')}</label>${h.form.select('task_order', qsheet.attr_value('task-order', default=' '), h.qsheet.task_pairs(qsheet.attr_value('task-count')), e, class_='role-qsheet-permute task-restriction', multiple="True", size="2")}</td>
    </tr>
    <tr>
      <td><label>Interfaces: </label><label id="interface_list">${h.qsheet.generate_interfaces(qsheet.attr_value('interface-count'))}</label></td>
      <td>${h.form.number_field('interface_count', qsheet.attr_value('interface-count', default='0'), e, class_='role-qsheet-permute', style='width:50px', min='0')}</td>
      <td>${h.form.select('interface_worb', qsheet.attr_value('interface-worb', default='w'), [('w', 'Within'), ('b', 'Between')], e, class_='role-qsheet-permute')}</td>
      <td><label class="interface-restriction">Exclude: </label></td>
	<td><label id="interface-disallow-repeater" style="display:none">${qsheet.attr_value('interface-disallow')}</label>${h.form.select('interface_disallow', qsheet.attr_value('interface-disallow', default=' '), h.qsheet.interface_pairs(qsheet.attr_value('interface-count')), e, class_='role-qsheet-permute interface-restriction', multiple="True", size="2")}</td>
      <td><label class="interface-restriction">Order:</label></td>
	<td><label id="interface-order-repeater" style="display:none">${qsheet.attr_value('interface-order')}</label>${h.form.select('interface_order', qsheet.attr_value('interface-order', default=' '), h.qsheet.interface_pairs(qsheet.attr_value('interface-count')), e, class_='role-qsheet-permute interface-restriction', multiple="True", size="2")}</td>
    </tr>
    <tr>
      <td><label>Number of participants needed for this arrangement:</label></td> 
      <td><label id="pcount">$pcount</label></td>
      <td><label id="test_output"></label></td>
    </tr>
  </table>
</span>
