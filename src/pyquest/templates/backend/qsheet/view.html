<!DOCTYPE html>
<html xmlns:py="http://genshi.edgewall.org/">
  <head>
    <title>${survey.title} - ${qsheet.title}</title>
    <link rel="stylesheet" type="text/css" href="${r.static_url('pyquest:static/css/screen.css')}"/>
    <link rel="stylesheet" type="text/css" href="${r.static_url('pyquest:static/css/backend.css')}"/>
    <link rel="stylesheet" type="text/css" href="${r.static_url('pyquest:static/css/frontend.css')}"/>
    <link rel="stylesheet" type="text/css" href="${r.static_url('pyquest:static/css/buttons/screen.css')}"/>
    <link rel="stylesheet" type="text/css" href="${r.static_url('pyquest:static/css/themes/basic.css')}"/>
    <script type="text/javascript" src="${r.static_url('pyquest:static/js/jquery-1.7.1.min.js')}"></script>
    <script type="text/javascript" src="${r.static_url('pyquest:static/js/jquery-ui-1.8.17.min.js')}"></script>
    <script type="text/javascript">
    $(document).ready(function() {
    	$('.question.ranking ul select').hide();
    	$('.question.ranking ul').sortable({
    		update: function(e, ui) {
    			var items = $(this).sortable('toArray');
    			for(var idx in items) {
    				console.log('#' + items[idx].replace('_', '.').replace(/\./g, '\\.'));
    				$('#' + items[idx].replace('_', '.').replace(/\./g, '\\.')).val(idx);
    			}
    		}
    	});
    });
    </script>
  </head>
  <body>
    <div class="container">
      ${h.ui.breadcrumbs([(survey.title, {'href': r.route_url('survey.view', sid=survey.id)}), ('Pages', {'href': r.route_url('survey.qsheet', sid=survey.id)}), (qsheet.title, {'href': r.route_url('survey.qsheet.view', sid=survey.id, qsid=qsheet.id)})], r)}
      ${h.survey.fancy_status(r, survey.status, class_='survey-status right')}
      ${h.ui.main_menu('pages', survey, r)}
      <nav class="toolbar">
        <ul>
          <li py:if="h.auth.is_authorised(':survey.is-owned-by(:user) or :user.has_permission(\'survey.edit-all\')', {'user': h.user.current_user(r), 'survey': survey})"><a href="${r.route_url('survey.qsheet.edit', sid=survey.id, qsid=qsheet.id)}" class="button">Edit</a></li>
          <li py:if="h.auth.is_authorised(':survey.is-owned-by(:user) or :user.has_permission(\'survey.delete-all\')', {'user': h.user.current_user(r), 'survey': survey})"><a href="${r.route_url('survey.qsheet.delete', sid=survey.id, qsid=qsheet.id)}" class="button post-submit" data-confirm="Please confirm that you wish to delete the page &quot;${qsheet.title}&quot;.">Delete</a></li>
        </ul>
      </nav>
      <article>
        <hgroup>
          <h1>${survey.title}</h1>
        </hgroup>
      </article>
    </div>
    <article class="survey">
      <section class="qsheet">
        <hgroup>
          <h1>${qsheet.title}</h1>
        </hgroup>
        <p class="success" py:if="r.method == 'POST' and not e">Your submission passed the validation</p>
        <p class="error" py:if="r.method == 'POST' and e">Unfortunately your submission did not pass the validation</p>
        <form action="${r.route_url('survey.qsheet.view', sid=survey.id, qsid=qsheet.id)}" method="post">
          ${h.form.hidden_field('items.%i.csrf_token_' % (example['did']), r.session.get_csrf_token())}
          ${h.qsheet.display(example, qsheet.content, e)}
          <ul class="buttons">
            <li>${h.form.submit('Test validation', class_='button')}</li>
          </ul>
        </form>
      </section>
    </article>
  </body>
</html>