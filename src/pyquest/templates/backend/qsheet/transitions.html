<span xmlns:py="http://genshi.edgewall.org/" xmlns:xi="http://www.w3.org/2001/XInclude">
  <py:with vars="transition_destinations=h.qsheet.transition_destinations(qsheet); question_list=h.qsheet.question_list(qsheet)">
    <py:for each="idx, t in enumerate(sorted(qsheet.next, key=h.qsheet.transition_sorter, reverse=True))">
      <section class="transition">
	<py:choose test="t.condition">
	  <py:when test="None">
	    <b> default: </b>
	    ${h.form.hidden_field('transitions-%i.id' %(idx), t.id)}
	    ${h.form.select('transitions-%i.target_id' %(idx), t.target_id, transition_destinations, e)}
	    ${h.form.button('AddCondition', class_='add-transition-condition')}
	    ${h.form.button('DeleteCondition', class_='delete-transition-condition')}
	  </py:when>
	  <py:otherwise>
	    <b>condition ${idx+1}: if answer to question</b> 
	    ${h.form.hidden_field('transitions-%i.id' %(idx), t.id)}
	    ${h.form.select('transitions-%i.condition.question_id' %(idx), t.condition.question_id, question_list, e)}
	    <b>is </b> 
	    ${h.form.text_field('transitions-%i.condition.expected_answer' %(idx), t.condition.expected_answer, e)} 
	    <b> then </b>
	    ${h.form.select('transitions-%i.target_id' % (idx), t.target_id, transition_destinations, e)}
	  </py:otherwise>
	</py:choose>
      </section>
    </py:for>
  </py:with>
</span>
