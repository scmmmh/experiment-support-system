<!DOCTYPE html>
<html xmlns:py="http://genshi.edgewall.org/" xmlns:xi="http://www.w3.org/2001/XInclude">
  <xi:include href="../../layout/backend.html"/>
  <head>
    <title>${survey.title} - Results - Export by Question</title>
  </head>
  <body>
    ${h.ui.survey_breadcrumbs([(survey.title, {'href': r.route_url('survey.view', sid=survey.id)}), ('Results', {'href': r.route_url('survey.results', sid=survey.id)}), ('Export by Question', {'href': r.route_url('survey.results.by_question', sid=survey.id)})], r)}
    ${h.survey.fancy_status(r, survey, class_='survey-status right')}
    ${h.ui.main_menu('results', survey, r)}
    <nav class="toolbar">
      <ul>
        <li>          
	  <form action="${r.route_url('survey.results.by_question.ext', sid=survey.id, ext='csv')}" method="post">${h.form.submit('Download as CSV', class_='button')}
            ${h.form.hidden_field('na_value', na_value)}
            ${h.form.checkbox('spss_safe', spss_safe, e, checked=spss_safe)}
        </form></li>
      </ul>
    </nav>
    <article>
      <hgroup>
        <h1>${survey.title} - Results - Export by Question</h1>
      </hgroup>
      <form action="${r.route_url('survey.results.by_question', sid=survey.id)}" method="post">
	<hgroup>
          <h2>Export Settings</h2>
	</hgroup>
	<dl>
          <dt>Non-answered value</dt>
          <dd>${h.form.text_field('na_value', na_value, e)}</dd>
          <dt>SPSS Safe Columns</dt>
          <dd>${h.form.checkbox('spss_safe', spss_safe, e, checked=spss_safe)}</dd>
	</dl>
	<ul class="buttons">
          <li>${h.form.submit('Update Settings', class_='button')}</li>
	</ul>
      </form>
      <div class="span-24" style="overflow:auto;">
	<hgroup>
          <h2>Sample Data</h2>
	</hgroup>
	<table>
          <thead>
            <tr>
              <th py:for="column in columns">${column}</th>
            </tr>
          </thead>
          <tbody>
            <tr py:for="row in rows[0:30]">
              <td py:for="column in columns"><py:if test="column in row">${row[column]}</py:if></td>
            </tr>
          </tbody>
	</table>
      </div>
      <aside py:if="len(rows) > 20">This is only an excerpt of the available data. Use the "Download as CSV" button to export all results.</aside>
    </article>
  </body>
</html>
