<!DOCTYPE html>
<html xmlns:py="http://genshi.edgewall.org/" xmlns:xi="http://www.w3.org/2001/XInclude">
  <xi:include href="../../layout/backend.html"/>
  <head>
    <title>${survey.title} - Results - Download By Participant</title>
    <script type="text/javascript">
      $(document).ready(function() {
          $('#data-id-form input[type=submit]').hide();
          $('#data-id-form select').change(function(ev, ui) {
             $('#data-id-form').submit(); 
          });
      });
    </script>
  </head>
  <body>
    ${h.ui.survey_breadcrumbs([(survey.title, {'href': r.route_url('survey.view', sid=survey.id)}), ('Results', {'href': r.route_url('survey.results', sid=survey.id)}), ('Download By Participant', {'href': r.route_url('survey.results.participant', sid=survey.id)})], r)}
    ${h.survey.fancy_status(r, survey, class_='survey-status right')}
    ${h.ui.main_menu('results', survey, r)}
    <nav class="toolbar">
      <ul>
        <li><a href="${r.route_url('survey.results.participant.ext', sid=survey.id, ext='csv', _query=r.params)}" class="button">Download as CSV</a></li>
      </ul>
    </nav>
    <article>
      <hgroup>
        <h1>${survey.title} - Results - Download Raw Data</h1>
      </hgroup>
      <form id="data-id-form" action="${r.route_url('survey.results.participant', sid=survey.id)}" method="get" class="text-right" py:if="data_attr">
        <label for="data-identifier">Data identifier</label>
        ${h.form.select('data_identifier', data_identifier, data_attr, e, id='data-identifier')}
        ${h.form.submit('Update', class_='button')}
      </form>
      <div class="span-24" style="overflow:auto;">
        <table>
          <thead>
            <tr>
              <th py:for="column in columns">${column}</th>
            </tr>
          </thead>
          <tbody>
            <tr py:for="row in rows[0:20]">
              <td py:for="column in columns"><py:if test="column in row">${row[column]}</py:if></td>
            </tr>
          </tbody>
        </table>
      </div>
    </article>
  </body>
</html>